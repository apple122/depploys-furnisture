{"ast":null,"code":"var _jsxFileName = \"H:\\\\Apple-Funiture\\\\Furnisture\\\\src\\\\Page\\\\Users\\\\Categories\\\\Omise.open.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport Script from \"react-load-script\";\nimport axios from 'axios';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { ContextCate } from './ConCategory';\nimport data from './data';\nimport swal from 'sweetalert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet OmiseCard;\nexport default function Omise_open(props) {\n  _s();\n  var _APICUR$;\n  let Navigate = useNavigate();\n  const [APICUR, setAPICUR] = useState(0);\n  useEffect(() => {\n    axios.get(data.Mainurl + data.Currency).then(res => {\n      setAPICUR(res.data);\n    });\n  }, []);\n  let location = useLocation();\n  const [item] = useState(location.state.item);\n  const [number] = useState(location.state.Number);\n  let amountA = ((item.v2sprice - (item.v2sprice - item.v2percent) * item.v2percent / 100) * number / ((_APICUR$ = APICUR[0]) === null || _APICUR$ === void 0 ? void 0 : _APICUR$.Currency)).toFixed(0);\n  const handleLoadScript = () => {\n    OmiseCard = window.OmiseCard;\n    OmiseCard.configure({\n      publicKey: 'pkey_test_5s9anns9sj9o4hmyddu',\n      currency: 'USD',\n      frameLabel: 'Furnisfure SHOP',\n      submitLabel: 'Pay NOW',\n      buttonLabel: 'Pay with Omise'\n    });\n  };\n  const creditCardConfigure = () => {\n    OmiseCard.configure({\n      defaultPaymentMethod: 'credit_card',\n      otherPaymentMethods: []\n    });\n    OmiseCard.configureButton(\"#credit-card\");\n    OmiseCard.attach();\n  };\n  const HandleSubmit = e => {\n    try {\n      axios.post(data.Mainurl + data.POSTOMISE, {\n        'token': e,\n        'amount': amountA + '00'\n      }).then(res => {\n        var _item$v1typeId;\n        axios.post(data.Mainurl + data.POSTSALE, {\n          \"Image\": props.arrimg,\n          \"itemId\": item._id,\n          \"v2Items\": item.v2Items,\n          \"sellPercent\": item.v2percent,\n          \"sellSize\": item.v2size,\n          \"sellType\": (_item$v1typeId = item.v1typeId) === null || _item$v1typeId === void 0 ? void 0 : _item$v1typeId.pro_type,\n          \"sellColor\": item.v2color,\n          \"sellQty\": number,\n          \"sellbprice\": item.v2sprice,\n          \"sellAmount\": amountA,\n          \"Location\": props.arrlocations\n        }).then(req => {\n          axios.patch(data.Mainurl + data.PATCHITEM + item._id, {\n            \"v2qty\": item.v2qty - number\n          }).then(res => {\n            swal(\"ການສຳລະເງີນສຳເລັດ!\", {\n              icon: \"success\"\n            }).then(willDelete => {\n              if (willDelete) {\n                Navigate('/POST', {\n                  state: req.data\n                });\n                // window.location.reload(false)\n              }\n            });\n          });\n        });\n      });\n    } catch (error) {\n      swal(\"ການສຳລະເງີນສຳເລັດ!\", {\n        icon: \"error\"\n      }).then(willDelete => {\n        if (willDelete) {\n          window.location.reload(false);\n        }\n      });\n    }\n  };\n  const OmiseHandle = () => {\n    OmiseCard.open({\n      amount: amountA + '00',\n      onCreateTokenSuccess: nonce => {\n        HandleSubmit(nonce);\n      },\n      onFormClosed: () => {\n        /* Handler on form closure. */\n      }\n    });\n  };\n  const handleClick = e => {\n    e.preventDefault();\n    OmiseHandle();\n    creditCardConfigure();\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Script, {\n      url: \"https://cdn.omise.co/omise.js\",\n      onLoad: handleLoadScript\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"credit-card\",\n        type: \"button\",\n        onClick: handleClick,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"border text-[24px] px-3 py-1 bg-red-500 text-white\",\n          children: \"\\u0E8D\\u0EB7\\u0E99\\u0E8D\\u0EB1\\u0E99\\u0E81\\u0EB2\\u0E99\\u0EAA\\u0EB1\\u0EC8\\u0E87\\u0E8A\\u0EB7\\u0EC9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n_s(Omise_open, \"Fz+hQm0ANERQMHeVYcb7lfTT93s=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = Omise_open;\nvar _c;\n$RefreshReg$(_c, \"Omise_open\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Script","axios","useLocation","useNavigate","ContextCate","data","swal","jsxDEV","_jsxDEV","Fragment","_Fragment","OmiseCard","Omise_open","props","_s","_APICUR$","Navigate","APICUR","setAPICUR","get","Mainurl","Currency","then","res","location","item","state","number","Number","amountA","v2sprice","v2percent","toFixed","handleLoadScript","window","configure","publicKey","currency","frameLabel","submitLabel","buttonLabel","creditCardConfigure","defaultPaymentMethod","otherPaymentMethods","configureButton","attach","HandleSubmit","e","post","POSTOMISE","_item$v1typeId","POSTSALE","arrimg","_id","v2Items","v2size","v1typeId","pro_type","v2color","arrlocations","req","patch","PATCHITEM","v2qty","icon","willDelete","error","reload","OmiseHandle","open","amount","onCreateTokenSuccess","nonce","onFormClosed","handleClick","preventDefault","children","url","onLoad","fileName","_jsxFileName","lineNumber","columnNumber","id","type","onClick","className","_c","$RefreshReg$"],"sources":["H:/Apple-Funiture/Furnisture/src/Page/Users/Categories/Omise.open.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport Script from \"react-load-script\";\r\nimport axios from 'axios'\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { ContextCate } from './ConCategory';\r\nimport data from './data';\r\nimport swal from 'sweetalert'\r\n\r\nlet OmiseCard;\r\n\r\nexport default function Omise_open(props) {\r\n\r\n    let Navigate = useNavigate()\r\n\r\n    const [APICUR, setAPICUR] = useState(0)\r\n    useEffect(() => {\r\n        axios.get(data.Mainurl + data.Currency).then((res) => {\r\n            setAPICUR(res.data)\r\n        })\r\n    }, [])\r\n\r\n    let location = useLocation()\r\n    const [item] = useState(location.state.item)\r\n    const [number] = useState(location.state.Number)\r\n\r\n    let amountA = ((((item.v2sprice - (((item.v2sprice - item.v2percent) * item.v2percent) / 100)) * number) / (APICUR[0]?.Currency)).toFixed(0));\r\n\r\n    const handleLoadScript = () => {\r\n        OmiseCard = window.OmiseCard\r\n        OmiseCard.configure({\r\n            publicKey: 'pkey_test_5s9anns9sj9o4hmyddu',\r\n            currency: 'USD',\r\n            frameLabel: 'Furnisfure SHOP',\r\n            submitLabel: 'Pay NOW',\r\n            buttonLabel: 'Pay with Omise'\r\n        });\r\n    }\r\n\r\n    const creditCardConfigure = () => {\r\n        OmiseCard.configure({\r\n            defaultPaymentMethod: 'credit_card',\r\n            otherPaymentMethods: []\r\n        });\r\n        OmiseCard.configureButton(\"#credit-card\");\r\n        OmiseCard.attach();\r\n    }\r\n\r\n    const HandleSubmit = (e) => {\r\n        try {\r\n            axios.post(data.Mainurl + data.POSTOMISE, {\r\n                'token': e,\r\n                'amount': (amountA+'00')\r\n            }).then((res) => {\r\n                axios.post(data.Mainurl + data.POSTSALE, {\r\n                    \"Image\": props.arrimg,\r\n                    \"itemId\": (item._id),\r\n                    \"v2Items\": (item.v2Items),\r\n                    \"sellPercent\": (item.v2percent),\r\n                    \"sellSize\": (item.v2size),\r\n                    \"sellType\": (item.v1typeId?.pro_type),\r\n                    \"sellColor\": (item.v2color),\r\n                    \"sellQty\": number,\r\n                    \"sellbprice\": item.v2sprice,\r\n                    \"sellAmount\": (amountA),\r\n                    \"Location\": props.arrlocations\r\n                }).then((req) => {\r\n                    axios.patch(data.Mainurl + data.PATCHITEM + item._id, {\r\n                        \"v2qty\": (item.v2qty - number)\r\n                    }).then((res) => {\r\n                        swal(\"ການສຳລະເງີນສຳເລັດ!\", {\r\n                            icon: \"success\",\r\n                        }).then((willDelete) => {\r\n                            if (willDelete) {\r\n                                Navigate('/POST', { state: req.data })\r\n                                // window.location.reload(false)\r\n                            }\r\n                        });\r\n                    })\r\n                })\r\n            })\r\n        } catch (error) {\r\n            swal(\"ການສຳລະເງີນສຳເລັດ!\", {\r\n                icon: \"error\",\r\n            }).then((willDelete) => {\r\n                if (willDelete) {\r\n                    window.location.reload(false)\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    const OmiseHandle = () => {\r\n        OmiseCard.open({\r\n            amount: (amountA + '00'),\r\n            onCreateTokenSuccess: (nonce) => {\r\n                HandleSubmit(nonce)\r\n            },\r\n            onFormClosed: () => {\r\n                /* Handler on form closure. */\r\n            },\r\n        })\r\n    }\r\n\r\n    const handleClick = (e) => {\r\n        e.preventDefault();\r\n        OmiseHandle()\r\n        creditCardConfigure();\r\n    }\r\n    return (\r\n        <>\r\n            <Script\r\n                url=\"https://cdn.omise.co/omise.js\"\r\n                onLoad={handleLoadScript}\r\n            />\r\n            <form>\r\n                <div\r\n                    id=\"credit-card\"\r\n                    type=\"button\"\r\n                    onClick={handleClick}\r\n                >\r\n                    <button type='submit' className='border text-[24px] px-3 py-1 bg-red-500 text-white'>ຍືນຍັນການສັ່ງຊື້</button>\r\n                </div>\r\n            </form>\r\n        </>\r\n\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}